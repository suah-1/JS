<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œí—˜ ê²°ê³¼</title>
    <link rel="stylesheet" href="css/result.css">
</head>
<body>
    <div class="container">
        <h1>EXPLANATION</h1>
        <P>ê° ë¬¸ì œë¥¼ í´ë¦­í•˜ì—¬ í’€ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</P>

        <!-- ì •ë‹µ ë¦¬ìŠ¤íŠ¸ -->
        <h2>âœ… ì •ë‹µ ë¦¬ìŠ¤íŠ¸</h2>
        <div id="correct-list"></div>

        <!-- ì˜¤ë‹µ ë¦¬ìŠ¤íŠ¸ -->
        <h2>âŒ ì˜¤ë‹µ ë¦¬ìŠ¤íŠ¸</h2>
        <div id="incorrect-list"></div>

        <button class="retrybutton" onclick="retryExam()" style="margin-top: 20px;">ë‹¤ì‹œ ì‹œí—˜ ë³´ê¸°</button>

        <button class="homebutton" onclick="home()"><svg xmlns="http://www.w3.org/2000/svg" height="50px"
            viewBox="0 -960 960 960" width="50px" fill="#5f6368">
            <path d="M160-120v-480l320-240 320 240v480H560v-280H400v280H160Z" />
        </svg></button>
    </div>

    <script>
        function home() {
            window.location.href = "home.html";
        }

        // ì €ì¥ëœ ê²°ê³¼ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const results = JSON.parse(localStorage.getItem("examResults") || "[]");

        const correctList = document.getElementById("correct-list");
        const incorrectList = document.getElementById("incorrect-list");

        if (results.length === 0) {
            correctList.innerHTML = "<p>ì •ë‹µì´ ì—†ìŠµë‹ˆë‹¤.</p>";
            incorrectList.innerHTML = "<p>ì˜¤ë‹µì´ ì—†ìŠµë‹ˆë‹¤.</p>";
        }

        results.forEach((result, index) => {
            const listItem = document.createElement("div");
            listItem.className = "question-item";

            // solutionì´ undefinedì¼ ê²½ìš° ëŒ€ë¹„
            const solutionText = result.solution ? result.solution : "í’€ì´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";

            listItem.innerHTML = `
                <strong>${index + 1}. ${result.question}</strong>
                <p>âœ… ì •ë‹µ: ${result.correctAnswer}</p>
                <p>ğŸ“ ë‚´ ë‹µ: ${result.selectedAnswer}</p>
                <div class="solution" id="solution-${index}">
                    <p>ğŸ’¡ í’€ì´: ${solutionText}</p>
                </div>
            `;

            listItem.addEventListener("click", () => toggleSolution(index, listItem));

            if (result.isCorrect) {
                correctList.appendChild(listItem);
            } else {
                incorrectList.appendChild(listItem);
            }
        });

        // í’€ì´ ì•„ì½”ë””ì–¸ ê¸°ëŠ¥
        function toggleSolution(index, element) {
            const solutionDiv = document.getElementById(`solution-${index}`);
            const isVisible = solutionDiv.style.display === "block";

            // ëª¨ë“  í’€ì´ ë‹«ê¸°
            document.querySelectorAll(".solution").forEach(div => div.style.display = "none");
            document.querySelectorAll(".question-item").forEach(item => item.classList.remove("active"));

            // í´ë¦­í•œ ë¬¸ì œì˜ í’€ì´ë§Œ ì—´ê¸°/ë‹«ê¸°
            if (!isVisible) {
                solutionDiv.style.display = "block";
                element.classList.add("active");
            }
        }

        // ë‹¤ì‹œ ì‹œí—˜ ë³´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ select.htmlë¡œ ì´ë™
        function retryExam() {
            localStorage.removeItem("examResults"); // ì´ì „ ê²°ê³¼ ì‚­ì œ
            window.location.href = "select.html";
        }
    </script>
</body>

</html>